@using SOEN341InstagramReplica.Models
@model PostAndComments
@{
    ViewBag.Title = "Details2";
}
<script>
    function likeOrDislike(likeStatus) {
        if (likeStatus == 1) { //They clicked like
            alert("clicked like= " + likeStatus);
        } else { //They clicked dislike
            alert("clicked dislike= " + likeStatus);
        }
        //newRatingStatus, int loggedInUser, int postID

        $.post('@Url.Action("LikeOrDislike", "UserPosts")',
            { "newRatingStatus": likeStatus, "loggedInUser": @Session["id"], "postID": @Model.post.ID}).done
            (function (data) {
                var parsed_data = JSON.parse(data);
                alert("here");
                alert(data);
                alert(data.LikeOrDislike);

                });

    }

</script>
@if (Session["username"] != null && Session["username"].ToString() != Model.postUserName)
{//LightBlue = style="background-color:#ADD8E6"
    <input type="button" id="likeButton"
           value="Like" class="btn btn-default" onclick="likeOrDislike(1)" />
    <input type="button" id="likeButton"
           value="Dislike" class="btn btn-default" onclick="likeOrDislike(2)" />
}
<h2>Post</h2>
<h1>Title: @Model.post.Title</h1>
<h1>User: @Html.ActionLink(Model.postUserName.ToString(), "Details2", "Users", new { id = Model.post.User_ID }, null)</h1>

@{
    var base64 = Convert.ToBase64String(Model.post.POST);
    var imgsrc = string.Format("data:image/png;base64,{0}", base64);
}


<img src='@imgsrc' style="max-width:75%;max-height:75%" />
<p>-----</p>
@if (Session["username"] != null)
{
    @Html.ActionLink("Create New Comment", "Create", "Comments", new { id = Model.post.ID }, null)

}

<table class="table">
    <tr>
        <th>
            Comment
        </th>
        <th>
            User
        </th>
    </tr>
    @foreach (var comment in Model.comments)
    {
        <tr>

            @if (Session["username"] != null && comment.Username == Session["username"].ToString())
            {
                <td>@comment.Comment1 | @Html.ActionLink("Delete Comment", "Delete", "Comments", new { id = comment.ID, postId = Model.post.ID }, null)</td>
            }
            else
            {
                <td>
                    @comment.Comment1
                </td>
            }
            <td>
                <a href="@Url.Action("Details2", "Users", new { id = comment.User_ID}, null)">
                    @comment.Username
                </a>
            </td>

        </tr>
    }
</table>